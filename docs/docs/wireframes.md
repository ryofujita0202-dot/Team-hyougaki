# GyoLog（ギョログ） ワイヤーフレーム
最終更新: 2025-09-20 / 版: v1.0 / 作成: team1_3peace

## 目次
- [0) 共通レイアウト（デスクトップ想定）](#0-共通レイアウトデスクトップ想定)
- [1) 画面A：検索・発見（子ビュー）](#1-画面a検索発見子ビュー)
- [2) 画面B：視聴・記録（子ビュー）](#2-画面b視聴記録子ビュー)
- [3) 画面C：学習ログ一覧（子ビュー）](#3-画面c学習ログ一覧子ビュー)
- [4) 画面D：親ダッシュボード（parentビュー）](#4-画面d親ダッシュボードparentビュー)
- [5) 画面E：ログイン登録（Supabase-Auth）](#5-画面eログイン登録supabase-auth)
- [M1) モーダル：評価・メモ](#m1-モーダル評価メモ)
- [画面間フロー（最短導線）](#画面間フロー最短導線)
- [コンポーネントID → データ/サービス対応表（抜粋）](#コンポーネントid--データサービス対応表抜粋)
- [モバイル（1カラム）補足](#モバイル1カラム補足)

---

## 0) 共通レイアウト（デスクトップ想定）

```

┌─────────────────────────────────────────────────────────────┐
│ 🐟 GyoLog（ギョログ）                                    │  ← ヘッダー：タイトル/ロゴ/ユーザー名/#nav-user
│─────────────────────────────────────────────────────────────│
│  ナビ                                                       │
│  ┌────────────────────────┐  ┌───────────────────────────┐
│  │ ● ホーム               │  │ ページコンテンツ           │
│  │   学習登録（子ビュー） │  │                           │
│  │   学習ログ一覧         │  │                           │
│  │   親ダッシュボード     │  │                           │
│  │                        │  │                           │
│  │ ────────────────      │  │                           │
│  │ ロール: child/parent   │  │                           │
│  │ 接続状況: YouTube/Gem… │  │                           │
│  └────────────────────────┘  └───────────────────────────┘
└─────────────────────────────────────────────────────────────┘

```

---

## 1) 画面A：検索・発見（子ビュー）

```

\#page=search
┌─────────────────────────────────────────────────────────────┐
│ 🔎 検索（#search-box）                                     │
│ \[キーワード入力 #q       ]\[検索]  フィルタ: \[長さ]\[並び替え] │
│─────────────────────────────────────────────────────────────│
│ 検索結果（#results, max 10）                               │
│ ┌─────────────────────────────────────────────────────────┐
│ │ \[サムネ]  タイトル（#title）        再生時間 #duration    │
│ │ チャンネル #channel                                     │
│ │ \[▶ 視聴] \[＋記録に追加] \[詳細] #actions                  │
│ └─────────────────────────────────────────────────────────┘ ×N
│─────────────────────────────────────────────────────────────│
│ 最近の学習トピック（チップ）#recent-topics                │
└─────────────────────────────────────────────────────────────┘

```

**主イベント**
- `検索` → YouTube検索API呼び出し（`services.youtube_client.search`）
- `▶視聴` → 画面Bへ `videoId` を持って遷移
- `＋記録に追加` → モーダルM1（評価/メモ）を開く

---

## 2) 画面B：視聴・記録（子ビュー）

```

\#page=watch
┌─────────────────────────────────────────────────────────────┐
│ 🎬 視聴：#video-title                                      │
│ \[YouTube IFrame #player 16:9]                              │
│  再生状態: \[●] 再生 / \[ ] 一時停止 / \[ ] 終了 #player-state │
│─────────────────────────────────────────────────────────────│
│ 評価とメモ（#record-form）                                 │
│ 評価 ★☆☆☆☆（1-5）#rating    学習日 #date                  │
│ メモ #note (多行)                                          │
│ \[保存]（STT→要約ジョブを起動 / 失敗時はメモのみ保存）     │
│─────────────────────────────────────────────────────────────│
│ 自動要約（処理後に反映 #summary-panel）                    │
│  - 要点（最大5）                                           │
│  - 3行要約                                                 │
│  - 章立て                                                  │
│  - 引用範囲（開始/終了秒）                                 │
│ \[Nano Bananaで読みやすくする] #nano-banana-btn             │
│─────────────────────────────────────────────────────────────│
│ 魚の成長（#fish-card） 連続日数 / ポイント / 成長バー      │
└─────────────────────────────────────────────────────────────┘

```

**主イベント**
- IFrame `ENDED` → `#watch_seconds` 推定を加算
- `保存` → view_log作成（`repositories.supabase_repo.save_view_log`）
- 要約は非同期反映（成功時 `#summary-panel` を更新）

---

## 3) 画面C：学習ログ一覧（子ビュー）

```

\#page=logs
┌─────────────────────────────────────────────────────────────┐
│ 📚 学習ログ一覧                                             │
│ \[キーワード #kw ]\[期間:すべて/7日/30日]\[並び替え]         │
│─────────────────────────────────────────────────────────────│
│ ┌─────────────────────────────────────────────────────────┐
│ │ タイトル（#title）  再生時間/視聴秒 #duration/#watch\_s   │
│ │ チャンネル #channel   学習日 #watched\_at  回数 #count     │
│ │ 要約（折りたたみ #summary）                              │
│ │ \[再生] \[編集] \[削除] \[詳細へ] #row-actions               │
│ └─────────────────────────────────────────────────────────┘ ×N
│─────────────────────────────────────────────────────────────│
│ 合計：本数 / 総視聴時間 / 平均評価（#stats）               │
└─────────────────────────────────────────────────────────────┘

```

**主イベント**
- `編集` → モーダルM1（評価/メモ）
- `削除` → 確認モーダル → 削除（ソフトデリートでも可）

---

## 4) 画面D：親ダッシュボード（parentビュー）

```

\#page=parent\_dashboard
┌─────────────────────────────────────────────────────────────┐
│ 👪 親ダッシュボード                                         │
│ フィルタ: \[期間]\[子ユーザー]  KQIカード #kqi                │
│ \[総ログ数] \[総学習時間] \[平均評価] \[連続日数 最大]          │
│─────────────────────────────────────────────────────────────│
│ トピック別件数（上位10） #topic-table                       │
│  トピック | 件数                                            │
│─────────────────────────────────────────────────────────────│
│ タイムライン（棒/折れ線）#timeline-chart                    │
│─────────────────────────────────────────────────────────────│
│ 子ユーザー別サマリ #by-user                                 │
│  ユーザー | 本数 | 時間 | 平均評価 | 直近学習日 | レベル    │
└─────────────────────────────────────────────────────────────┘

```

---

## 5) 画面E：ログイン/登録（Supabase-Auth）

```

\#page=auth
┌─────────────────────────────────────────────────────────────┐
│ ログイン                                                   │
│ \[メール] \[パスワード] \[ログイン]                           │
│─────────────────────────────────────────────────────────────│
│ 新規登録                                                   │
│ \[メール] \[パスワード] \[確認用パスワード] \[登録]            │
│  ロール: ( ) child  ( ) parent  表示名： \[       ]         │
└─────────────────────────────────────────────────────────────┘

```

---

## M1) モーダル：評価・メモ（追加/編集）

```

┌───────────── 評価・メモ ──────────────────────────────┐
│ タイトル #title（読み取り）                                │
│ 評価 ★☆☆☆☆（#rating）                                     │
│ 学習日 #date                                               │
│ メモ #note (多行)                                          │
│ \[保存]  \[キャンセル]                                       │
└───────────────────────────────────────────────────────────┘

```

---

## 画面間フロー（最短導線）

1. **検索A** → `▶視聴` → **視聴B**
2. **視聴B** → `保存`（STT→要約）→ **一覧C** に反映
3. **一覧C** → `詳細/編集` → **視聴B** または **モーダルM1**
4. **親D** はRLSの範囲で集計表示（family_id/roleに依存）
5. **ログインE** は初回のみ。以後は `#nav-user` からログアウト/切替

---

## コンポーネントID → データ/サービス対応表（抜粋）

| UI ID                     | データ/処理                                                                    |
|--------------------------|-------------------------------------------------------------------------------|
| `#results`               | `services.youtube_client.search()`                                           |
| `#player`                | YouTube IFrame API（再生/終了イベント）                                      |
| `#record-form`           | `repositories.supabase_repo.save_view_log()`                                 |
| `#summary-panel`         | `services.stt_client.transcribe()` → `services.gemini_client.summarize()`    |
| `#nano-banana-btn`       | `services.gemini_client.nano_banana()`                                       |
| `#logs` rows             | `repositories.supabase_repo.fetch_view_logs()`                               |
| `#fish-card`             | 学習レベル計算（Pythonロジック）                                             |
| `#kqi`, `#timeline-chart`| 親向け集計（サーバー集計 or クエリ）                                         |

---

## モバイル（1カラム）補足
- サイドバーはハンバーガーに収納
- IFrameは縦長スクロールの先頭に固定
- 一覧カードは1列表示
```

> READMEからリンクする場合：
>
> ```md
> - ワイヤーフレーム → [docs/wireframes.md](./docs/wireframes.md)
> ```
>
> アップロード手順（Web）：リポジトリ → **Add file ▸ Create new file** → `docs/wireframes.md` → 上記を貼り付け → **Commit changes**。
